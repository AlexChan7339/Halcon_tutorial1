# 7-图像操作

# 打开图像选择弹窗

```python
dev_open_file_dialog ('read_image', 'default', 'default', Selection)
```

dev_open_file_dialog( : : Filter, Mode, Path : Selection)

- `dev_open_file_dialog`打开一个文件选择对话框，用于读取一个文件（Mode = 'read‘），读取一个或多个文件（Mode = ’read_multi‘），写入（Mode = ’write‘）文件或选择（Mode = ’dir'）目录。如果Mode设置为“default”，Filter设置为HALCON操作符，则类型设置为操作符将使用的值。
- filter过滤器可以用来选择要选择读取或写入的文件类型。Filter可以设置为一个HALCON操作符，例如read_image，它应该读取或写入所选文件。在这种情况下，过滤器被设置为适合于HALCON操作符使用的文件。
  - 要选择JPEG和TIFF类型的图像，过滤器可以设置为‘ images (*.jpg *.tif *.tiff)’或'JPEG Files (*.jpg);；TIFF-Files (*.tif *.tiff)'。*
    - *在第一种情况下，通过选择“Images”条目，所有支持的图像文件都会一起显示。
    - *在第二种情况下，可以选择JPEG文件或TIFF文件。Filter不区分大小写，因此‘JPEG Files (*.jpg)’和‘JPEG Files (*.jpg)’提供相同的结果。总是添加“所有文件（*）”。要组合多个过滤器，必须用‘;;’分隔它们。

> 运行该行代码后，会弹出一个窗口，选择图像文件，控制百年来区域中会出现`Selection`,它的值为文件路径

# 根据路径选择图像

```python
read_image (Image, Selection)
* 等同 read_image (Image, 'D:/CALB/软件&算法&读书/Halcon/5-机器视觉应用通用流程/1.bmp')
```

# rgb转灰度图

按住`Ctrl`可以看到彩色图像的RGB值（三个通道数值）

<img src="https://typora3.oss-cn-shanghai.aliyuncs.com/202508241104699.png" alt="image-20250824110457359" style="zoom:50%;" />

```python
rgb1_to_gray (Image, GrayImage)
```

此时图像会变成灰度图，此时按住`Ctrl`可以看到灰度值

<img src="https://typora3.oss-cn-shanghai.aliyuncs.com/202508241107045.png" alt="image-20250824110706513" style="zoom:33%;" />

# 分解RGB

将RGB图像分解为三张图像，有时我们会选择某个通道图像进行检测和操作，可某个通道的图像上某个特征更明显，检测更容易

```python
decompose3 (Image, R, G, B)
```

>R:
>
><img src="https://typora3.oss-cn-shanghai.aliyuncs.com/202508241110101.png" alt="image-20250824111011039" style="zoom:33%;" />
>
>---
>
>G
>
><img src="https://typora3.oss-cn-shanghai.aliyuncs.com/202508241110438.png" alt="image-20250824111030378" style="zoom:33%;" />
>
>---
>
>B
>
><img src="https://typora3.oss-cn-shanghai.aliyuncs.com/202508241110503.png" alt="image-20250824111047439" style="zoom:33%;" />

# RGB转HSV

目的：让某个特征更明显，检测更容易

## HSV

> 自然环境下获取的图像容易受自然光照、遮挡和阴影等情况的影响，即对**亮度比较敏感**。而 RGB 颜色空间的三个分量都与亮度密切相关，即**只要亮度改变，三个分量都会随之相应地改变**，HSV可以更直观的方式来表达亮度。

HSV 表达彩色图像的方式由三个部分组成：

<img src="https://typora3.oss-cn-shanghai.aliyuncs.com/202508241116849.jpeg" alt="img" style="zoom:33%;" />

- Hue（色调、色相）

  Hue 用角度度量，取值范围为0～360°，表示色彩信息，即所处的光谱颜色的位置。颜色圆环上所有的颜色都是光谱上的颜色，从红色开始按逆时针方向旋转，Hue=0 表示红色，Hue=120 表示绿色，Hue=240 表示蓝色等等。

  <img src="https://typora3.oss-cn-shanghai.aliyuncs.com/202508241116890.jpeg" alt="img" style="zoom:50%;" />

- Saturation（饱和度、色彩纯净度）

  <img src="https://typora3.oss-cn-shanghai.aliyuncs.com/202508241117908.jpeg" alt="img" style="zoom:50%;" />

  其中水平方向表示饱和度，饱和度表示颜色接近光谱色的程度。饱和度越高，说明颜色越深，越接近光谱色饱和度越低，说明颜色越浅，越接近白色。饱和度为0表示纯白色。取值范围为0～100%，值越大，颜色越饱和。

- Value（明度）

  竖直方向表示明度，决定颜色空间中颜色的明暗程度，明度越高，表示颜色越明亮，范围是 0-100%。明度为0表示纯黑色（此时颜色最暗）。

```python
trans_from_rgb (R,G, B, H, S, V, 'hsv')
```

> H
>
> <img src="https://typora3.oss-cn-shanghai.aliyuncs.com/202508241119194.png" alt="image-20250824111917138" style="zoom:50%;" />
>
> ---
>
> S
>
> <img src="https://typora3.oss-cn-shanghai.aliyuncs.com/202508241119091.png" alt="image-20250824111945029" style="zoom:50%;" />
>
> ---
>
> V
>
> <img src="https://typora3.oss-cn-shanghai.aliyuncs.com/202508241120237.png" alt="image-20250824112003175" style="zoom:50%;" />

# 获取图像宽

```python
get_image_size (GrayImage, Width, Height)
```

# 生成单通道空图像

```py
gen_image_const (Image1, 'byte', Width, Height)
```

- `'byte'`: 每个像素 1 字节

> **输出图像**
>
> <img src="https://typora3.oss-cn-shanghai.aliyuncs.com/202508241124601.png" alt="image-20250824112430556" style="zoom:50%;" />

# 生成某固定值的单通道图像

```python
* 图像上所有像素值都是125
gen_image_proto (Image1, ImageOut, 125)

* 图像上所有像素值都是255（用的最多）
gen_image_proto (Image1, ImageOut2, 255)
* 图像上所有像素值都是0（用的最多）
gen_image_proto (Image1, ImageOut2, 0)

```

> **ImageOut**
>
> <img src="https://typora3.oss-cn-shanghai.aliyuncs.com/202508241126906.png" alt="image-20250824112607829" style="zoom:50%;" />
>
> ---
>
> **ImageOut2**
>
> <img src="https://typora3.oss-cn-shanghai.aliyuncs.com/202508241125540.png" alt="image-20250824112540497" style="zoom:50%;" />
>
> ---
>
> **ImageOut3**
>
> <img src="https://typora3.oss-cn-shanghai.aliyuncs.com/202508241128252.png" alt="image-20250824112815207" style="zoom:50%;" />

# 获取灰度图的灰度值

```python
get_grayval (GrayImage, [0,1], [0,1], Grayval)
* [25, 24]
```

输出图像上（0，0） 和（1，1 ）两个点的灰度值，分别为25 和 24 ， 用tuple格式来显示

# 修改灰度值(单像素修改)

```python
set_grayval (ImageOut, 1, 1, 255)
```

将（1，1）点的像素值改为255